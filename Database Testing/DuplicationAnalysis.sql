WITH cte AS (
    SELECT
        AccessFilePath
        ,[hdd]
        ,[dataabertura]
        ,[nid]
        ,[sexo]
        ,[datanasc]
        ,[idade]
        ,[meses]
        ,[coddistrito]
        ,[codproveniencia]
        ,[designacaoprov]
        ,[Codigoproveniencia]
        ,[emtarv]
        ,[datainiciotarv]
        ,[codestado]
        ,[destinopaciente]
        ,[datasaidatarv]
        ,[datadiagnostico]
        ,[aconselhado]
        ,[referidohdd]
        ,[datareferidohdd]
        ,[aceitabuscaactiva]
        ,[dataaceitabuscaactiva]
        ,[referidobuscaactiva]
        ,[datareferenciabuscaactiva]
        ,[situacaohiv]
        ,[observacao]
        ,[PatientID]
        ,[NewID]
        ,[Current_Age]
        ROW_NUMBER() OVER (
            PARTITION BY
            [hdd]
            ,[dataabertura]
            ,[nid]
            ,[sexo]
            ,[datanasc]
            ,[idade]
            ,[meses]
            ,[coddistrito]
            ,[codproveniencia]
            ,[designacaoprov]
            ,[Codigoproveniencia]
            ,[emtarv]
            ,[datainiciotarv]
            ,[codestado]
            ,[destinopaciente]
            ,[datasaidatarv]
            ,[datadiagnostico]
            ,[aconselhado]
            ,[referidohdd]
            ,[datareferidohdd]
            ,[aceitabuscaactiva]
            ,[dataaceitabuscaactiva]
            ,[referidobuscaactiva]
            ,[datareferenciabuscaactiva]
            ,[situacaohiv]
            ,[observacao]
            ,[PatientID]
            ,[NewID]
            ,[Current_Age]
            ORDER BY
            [hdd]
            ,[dataabertura]
            ,[nid]
            ,[sexo]
            ,[datanasc]
            ,[idade]
            ,[meses]
            ,[coddistrito]
            ,[codproveniencia]
            ,[designacaoprov]
            ,[Codigoproveniencia]
            ,[emtarv]
            ,[datainiciotarv]
            ,[codestado]
            ,[destinopaciente]
            ,[datasaidatarv]
            ,[datadiagnostico]
            ,[aconselhado]
            ,[referidohdd]
            ,[datareferidohdd]
            ,[aceitabuscaactiva]
            ,[dataaceitabuscaactiva]
            ,[referidobuscaactiva]
            ,[datareferenciabuscaactiva]
            ,[situacaohiv]
            ,[observacao]
            ,[PatientID]
            ,[NewID]
            ,[Current_Age]
        ) row_num
     FROM
        t_paciente
)
DELETE FROM cte
WHERE row_num > 1;
